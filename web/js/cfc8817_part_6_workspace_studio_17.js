workspace.studiopanel.getStudioMenu=function(){var b=workspace.workzone.getBeginMenu({onopen:function(g){e.setActiveTab(b.tabAccueil);workspace.studiopanel.studioPanel.codePanel.setActiveTab(workspace.studiopanel.openFile({path:g.path}))},savefile:function(){e.setActiveTab(b.tabAccueil);var g=workspace.studiopanel.studioPanel.codePanel.getActiveTab();if(typeof g.savefile!=="undefined"){g.savefile()}}});var a=Ext.create("Koolawa.ux.RibbonMenu",{id:"tabSource",title:"Source",cls:"tab-menu tab-studio",closable:false});b.push(a);var f=Ext.create("Koolawa.ux.RibbonMenu",{id:"tabRefactor",title:"Refactor",cls:"tab-menu tab-studio",closable:false});b.push(f);var d=Ext.create("Koolawa.ux.RibbonMenu",{id:"tabProjet",title:"Projet",cls:"tab-menu tab-studio",closable:false});b.push(d);var c=Ext.create("Koolawa.ux.RibbonMenu",{id:"tabExecuter",title:"Exécuter",cls:"tab-menu tab-studio",closable:false});b.push(c);b=workspace.workzone.getEndMenu(b);var e=Ext.create("Koolawa.ux.Ribbon",{id:"studioMenu",cls:"workspaceMenu",items:b,listeners:{afterrender:function(g){workspace.workzone.addShortMenu(g,[{cls:"icon-save_22white",tooltip:"Enregistrer",onclick:function(){var h=workspace.studiopanel.studioPanel.codePanel.getActiveTab();if(typeof h.savefile!=="undefined"){h.savefile()}}},{cls:"icon-undo_22white",tooltip:"Annuler la dernière action",onclick:function(){var h=workspace.studiopanel.studioPanel.codePanel.getActiveTab();if(typeof h.undo!=="undefined"){h.undo()}}},{cls:"icon-redo_22white",tooltip:"Refaire la dernière action",onclick:function(){var h=workspace.studiopanel.studioPanel.codePanel.getActiveTab();if(typeof h.redo!=="undefined"){h.redo()}}}])}}});$(window).on("resize",function(){var g=workspace.studiopanel.studioMenu;g.updateSize()});workspace.studiopanel.studioMenu=e;return e};workspace.studiopanel.generateStudiobox=function(c,a){var b="";b+="<div id='studiofile_"+c+"' class='studiofile'>";b+="	<textarea id='code_"+c+"' name='code_"+c+"'>"+a+"</textarea>";b+="</div>";return b};workspace.studiopanel.openFile=function(a){var c=workspace.studiopanel.lastNumber+1;while($("#tabStudioFile"+c).get().length!=0){c++}workspace.studiopanel.lastNumber=c;var b=Ext.create("Ext.Panel",{id:"tabStudioFile"+c,title:"Fichier "+c,iconCls:"icon-home",cls:"tab-studiofile",closable:true,currentfile:"Fichier "+c,countfile:c,listeners:{resize:function(){resizeStudioBox(b.countfile)},afterrender:function(g,e){if(typeof a.path!=="undefined"){var d=new Ext.LoadMask({target:b,msg:"Chargement en cours ..."});d.show();symfony("get","file","storage",{path:a.path},function(h){var i=workspace.studiopanel.generateStudiobox(b.countfile,h.data.content);b.update(i);b.currentfile=h.data.info.basename;b.setTitle(b.currentfile);startStudioBox(b.countfile);resizeStudioBox(b.countfile);globalStudiobox[b.countfile].editor.on("change",function(j){b.setTitle(b.currentfile+" *")});d.hide()})}else{var f=workspace.studiopanel.generateStudiobox(b.countfile,"commentaire");b.update(f);startStudioBox(b.countfile);resizeStudioBox(b.countfile);globalStudiobox[b.countfile].editor.on("change",function(h){b.setTitle(b.currentfile+" *")})}}},savefile:function(){var d=globalStudiobox[b.countfile].editor.getValue();symfony("save","file","storage",{path:a.path,content:d},function(e){if($.md5(d)===e.data.md5){b.setTitle(b.currentfile)}})},undo:function(){globalStudiobox[b.countfile].editor.undo()},redo:function(){globalStudiobox[b.countfile].editor.redo()}});workspace.studiopanel.studioPanel.codePanel.add(b);return b};workspace.studiopanel.getStudioPanel=function(){workspace.studiopanel.lastNumber=0;var c=Ext.create("Ext.Panel",{region:"west",id:"projectFilesPanel",minWidth:300,items:[]});var b=Ext.create("Ext.tab.Panel",{region:"center",id:"codePanel",resizeTabs:false,collapsible:false,items:[]});var d=Ext.create("Ext.Panel",{region:"east",id:"propertiesPanel",minWidth:250,items:[]});var a=Ext.create("Ext.Panel",{region:"center",id:"studioPanel",layout:"border",bodyBorder:false,defaults:{collapsible:true,split:true},items:[c,b,d]});a.projectFilesPanel=c;a.codePanel=b;a.propertiesPanel=d;workspace.studiopanel.studioPanel=a;workspace.studiopanel.studioMenu.centerPanel=a;return a};workspace.centerpanel.initStudioPanel=function(){workspace.studiopanel.studioPanel.codePanel.setActiveTab(workspace.studiopanel.openFile({title:"new file 1"}));workspace.studiopanel.openFile({title:"new file 2"})};