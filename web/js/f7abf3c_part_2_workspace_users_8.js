var clipboardUsers=undefined;var workspaceUsers={name:"users",current:null,users:[],groups:[],propertyData:null,properySource:null,init:function(){Ext.require(["Ext.ux.form.field.ToggleSlide","Ext.ux.toggleslide.Thumb"]);Ext.define("treeModel",{extend:"Ext.data.Model",fields:[{name:"Id",type:"int"},{name:"title",type:"string"},{name:"nodek",type:"string"},{name:"text",type:"string"},{name:"color",type:"string"},{name:"persist",type:"boolean"},{name:"groupid",type:"int"}]})},menuUsers:new Ext.menu.Menu({items:[{text:"Modifier l'utilisateur",key:"moduser"},{text:"Supprimer l'utilisateur",key:"deluser"},{xtype:"menuseparator"},{text:"Copier",key:"copyuser"},{text:"Couper",key:"cutuser"}],listeners:{click:function(c,a){switch(a.key){case"moduser":workspaceUsers.gotoUser(workspaceUsers.menuUsers.rec);break;case"deluser":var b=workspaceUsers.menuUsers.rec;Ext.MessageBox.show({title:"Totem : Suppression d'utilisateur",msg:"Etes-vous certain de vouloir supprimer l'utilisateur [ "+b.raw.username+" ] ?",width:400,buttons:Ext.MessageBox.YESNO,buttonText:{yes:"Oui",no:"Non"},fn:function(d){if(d=="yes"){var f=new Ext.LoadMask(centerPanel,{msg:"Suppression en cours ..."});f.show();var e=new Ext.LoadMask(workspaceUsers.itemUsers,{msg:"Suppression en cours ..."});e.show();symfony("delete","user","user",{id:b.raw.Id},function(g){b.remove(true);workspaceUsers.autoCloseCenterTab();f.hide();e.hide()})}}});break;case"copyuser":workspaceUsers.copy(workspaceUsers.menuUsers.rec);break;case"cutuser":workspaceUsers.cut(workspaceUsers.menuUsers.rec);break}}}}),menuGroupUsers:new Ext.menu.Menu({items:[{text:"Modifier ce groupe",key:"modgroup"},{id:"userdelete",text:"Supprimer ce groupe",key:"delgroup"},{xtype:"menuseparator"},{text:"Copier",key:"copygroup"},{text:"Couper",key:"cutgroup"},{id:"userpaste",text:"Coller",key:"paste",disabled:true},{xtype:"menuseparator"},{text:"Ajouter un utilisateur",key:"adduser"},{xtype:"menuseparator"},{text:"Règles par défaut de ce groupe",key:"rulegroup"}],listeners:{click:function(c,a){switch(a.key){case"copygroup":workspaceUsers.copy(workspaceUsers.menuGroupUsers.rec);break;case"cutgroup":workspaceUsers.cut(workspaceUsers.menuGroupUsers.rec);break;case"adduser":workspaceUsers.newUser(workspaceUsers.menuGroupUsers.rec);break;case"rulegroup":workspaceUsers.rulesUserGroup(workspaceUsers.menuGroupUsers.rec);break;case"paste":workspaceUsers.paste(workspaceUsers.menuGroupUsers.rec);break;case"addgroup":workspaceUsers.groupForm.load("Nouveau groupe","new",workspaceUsers.menuGroupUsers.rec).show();break;case"modgroup":workspaceUsers.groupForm.load("Modifier un groupe","update",workspaceUsers.menuGroupUsers.rec).show();break;case"delgroup":var b=workspaceUsers.menuGroupUsers.rec;Ext.MessageBox.show({title:"Totem : Suppression de groupe",msg:"Etes-vous certain de vouloir supprimer le groupe [ "+b.raw.title+" ] et tous les éléments qu'il contient ?",width:400,buttons:Ext.MessageBox.YESNO,buttonText:{yes:"Oui",no:"Non"},fn:function(d){if(d=="yes"){var f=new Ext.LoadMask(centerPanel,{msg:"Suppression en cours ..."});f.show();var e=new Ext.LoadMask(workspaceUsers.itemUsers,{msg:"Suppression en cours ..."});e.show();symfony("delete","group","user",{id:b.raw.Id},function(g){b.remove(true);workspaceUsers.autoCloseCenterTab();f.hide();e.hide()})}}});break}}}}),copy:function(a){clipboardUsers={item:a,action:"copy"};Ext.getCmp("userpaste").setDisabled(false);if(a.raw.nodek=="groupuser"){Ext.getCmp("userpasteroot").setDisabled(false)}},cut:function(a){clipboardUsers={item:a,action:"cut"};Ext.getCmp("userpaste").setDisabled(false);if(a.raw.nodek=="groupuser"){Ext.getCmp("userpasteroot").setDisabled(false)}},paste:function(d){var b=clipboardUsers.item;if(clipboardUsers.action=="cut"){if(clipboardUsers.item.raw.nodek=="user"){var a={id:clipboardUsers.item.raw.Id,groupid:d.raw.Id};symfony("save","user","user",a,function(e){if(workspaceUsers.current!=null&&workspaceUsers.current.Id==a.id){workspaceUsers.current.groupid=a.groupid}d.appendChild(b)})}else{if(clipboardUsers.item.raw.nodek=="groupuser"){var c={id:clipboardUsers.item.raw.Id,groupid:d.raw.Id};symfony("save","group","user",c,function(e){d.appendChild(b)})}}}else{if(clipboardUsers.item.raw.nodek=="user"){var a={id:clipboardUsers.item.raw.Id,groupid:d.raw.Id};symfony("clone","user","user",a,function(e){d.appendChild(e.data)})}else{if(clipboardUsers.item.raw.nodek=="groupuser"){var c={id:clipboardUsers.item.raw.Id,groupid:d.raw.Id};symfony("clone","group","user",c,function(e){d.appendChild(e.data)})}}}clipboardUsers=null;Ext.getCmp("userpaste").setDisabled(true);Ext.getCmp("userpasteroot").setDisabled(true)},menuRootGroupUsers:new Ext.menu.Menu({items:[{text:"Ajouter un groupe",key:"addgroup"},{xtype:"menuseparator"},{id:"userpasteroot",text:"Coller",key:"paste",disabled:true}],listeners:{click:function(b,a){switch(a.key){case"addgroup":workspaceUsers.groupForm.load("Nouveau groupe","new",workspaceUsers.menuGroupUsers.rec).show();break;case"paste":workspaceUsers.paste(workspaceUsers.menuGroupUsers.rec);break}}}}),groupForm:{load:function(g,d,f){var e=null;var c=null;if(d=="new"){e={raw:{Id:0,title:"",text:"",color:"x-cal-27-ad"}};c=f}if(d=="update"){e=f;c=f.parentNode}var b=new Ext.form.Panel({defaults:{labelWidth:150},modal:true,bodyStyle:"padding: 10px 10px 0 10px; background-color:#dfeaf2",layout:{type:"vbox",align:"stretch"},items:[{id:"name",xtype:"textfield",fieldLabel:"Nom",name:"name",value:e.raw.title},{xtype:"displayfield",fieldLabel:"Parent",name:"parent",value:(c.raw.Id==0||c.raw.Id==null)?"(Racine)":c.raw.title},{xtype:"tabpanel",flex:1,frame:true,bodyStyle:"padding: 10px 10px 0 10px;",items:[{title:"Informations",id:"group_informations",items:[{xtype:"textfield",fieldLabel:"Country",name:"country"},{xtype:"ux_colorcombo",fieldLabel:"Code couleur",id:"codecouleur",name:"codecouleur",forceSelection:true,editable:false,triggerAction:"all",allowBlank:false,value:e.raw.color}]},{title:"Droits du groupe",items:[{xtype:"textfield",fieldLabel:"Email",name:"email"}]}]}],buttons:[{text:"Enregistrer",handler:function(){var j=b.items.get("name").value;var i=(c.raw.Id)?c.raw.Id:0;var h=Ext.getCmp("group_informations").items.get("codecouleur").value;group={id:e.raw.Id,title:j,groupid:i,color:h};symfony("save","group","user",group,function(k){if(d=="new"){c.insertChild(-1,{Id:k.data.Id,title:group.title,text:group.title,color:h});if(!c.isExpanded()){c.expand()}}if(d=="update"){e.set("text",group.title);e.raw.text=group.title;e.raw.title=group.title;e.raw.color=group.color;e.commit()}a.close()})}},{text:"Annuler",handler:function(){a.close()}}]});var a=Ext.create("Ext.Window",{title:g,height:null,width:500,closable:true,items:[b]});return a}},autoCloseCenterTab:function(){centerPanel.items.each(function(c,b,d){if("user" in c&&c.user.Id!=0){var a={id:c.user.Id};symfony("exists","user","user",a,function(e){if(e.data.response=="false"){if(workspaceUsers.current.Id==a.id){workspaceUsers.current=null}centerPanel.remove(c)}})}})},rulesUserGroup:function(a){workspaceUsers.gotoUserGroup(a)},newUser:function(b){var a={groupid:b.raw.Id,title:"Nouvel utilisateur"};symfony("save","user","user",a,function(c){var d=b.insertChild(-1,c.data);workspaceUsers.gotoUser(d)})},gotoUser:function(b){var a=new Ext.LoadMask(centerPanel,{msg:"Chargement en cours ..."});a.show();workspaceUsers.getUser(b.raw.Id,function(c){var d=false;centerPanel.items.each(function(g,f,h){if(g.user&&c.Id==g.user.Id){d=true;centerPanel.setActiveTab(g)}});if(!d){var e=Ext.create("Ext.Panel",{title:b.raw.text,iconCls:"icon-user",items:[{xtype:"panel",frame:true,title:"Accueil",bodyStyle:"padding: 10px;",style:"margin-bottom:10px;",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Afficher la page d'accueil",onText:"actif",offText:"inactif",name:"welcomeDisplay",id:"welcomeDisplayU"+c.Id,state:c.rules.welcomeDisplay},{xtype:"toggleslidefield",fieldLabel:"Afficher les états qui datent de plus de 5 jours",onText:"actif",offText:"inactif",name:"welcomeMoreFiveDays",id:"welcomeMoreFiveDaysU"+c.Id,state:c.rules.welcomeMoreFiveDays},{xtype:"toggleslidefield",fieldLabel:"Afficher le nombre de téléchargement",onText:"actif",offText:"inactif",name:"welcomeCountDownload",id:"welcomeCountDownloadU"+c.Id,state:c.rules.welcomeCountDownload}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Requêtes",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux requêtes",onText:"actif",offText:"inactif",name:"queryDisplay",id:"queryDisplayU"+c.Id,state:c.rules.queryDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de requêtes",onText:"actif",offText:"inactif",name:"queryGroupCreate",id:"queryGroupCreateU"+c.Id,state:c.rules.queryGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de requêtes",onText:"actif",offText:"inactif",name:"queryGroupUpdate",id:"queryGroupUpdateU"+c.Id,state:c.rules.queryGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de requêtes",onText:"actif",offText:"inactif",name:"queryGroupDelete",id:"queryGroupDeleteU"+c.Id,state:c.rules.queryGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des requêtes",onText:"actif",offText:"inactif",name:"queryCreate",id:"queryCreateU"+c.Id,state:c.rules.queryCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des requêtes",onText:"actif",offText:"inactif",name:"queryUpdate",id:"queryUpdateU"+c.Id,state:c.rules.queryUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des requêtes",onText:"actif",offText:"inactif",name:"queryDelete",id:"queryDeleteU"+c.Id,state:c.rules.queryDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les requêtes",onText:"actif",offText:"inactif",name:"queryForceDisplay",id:"queryForceDisplayU"+c.Id,state:c.rules.queryForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Exécution des requêtes",onText:"actif",offText:"inactif",name:"queryRun",id:"queryRunU"+c.Id,state:c.rules.queryRun},{xtype:"toggleslidefield",fieldLabel:"Extraire les requêtes CSV",onText:"actif",offText:"inactif",name:"queryExtractCSV",id:"queryExtractCSVU"+c.Id,state:c.rules.queryExtractCSV},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des requêtes",onText:"actif",offText:"inactif",name:"queryDisplayLog",id:"queryDisplayLogU"+c.Id,state:c.rules.queryDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Rapports",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux rapports",onText:"actif",offText:"inactif",name:"reportDisplay",id:"reportDisplayU"+c.Id,state:c.rules.reportDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de rapports",onText:"actif",offText:"inactif",name:"reportGroupCreate",id:"reportGroupCreateU"+c.Id,state:c.rules.reportGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de rapports",onText:"actif",offText:"inactif",name:"reportGroupUpdate",id:"reportGroupUpdateU"+c.Id,state:c.rules.reportGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de rapports",onText:"actif",offText:"inactif",name:"reportGroupDelete",id:"reportGroupDeleteU"+c.Id,state:c.rules.reportGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des rapports",onText:"actif",offText:"inactif",name:"reportCreate",id:"reportCreateU"+c.Id,state:c.rules.reportCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des rapports",onText:"actif",offText:"inactif",name:"reportUpdate",id:"reportUpdateU"+c.Id,state:c.rules.reportUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des rapports",onText:"actif",offText:"inactif",name:"reportDelete",id:"reportDeleteU"+c.Id,state:c.rules.reportDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les rapports",onText:"actif",offText:"inactif",name:"reportForceDisplay",id:"reportForceDisplayU"+c.Id,state:c.rules.reportForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Exécuter les rapports",onText:"actif",offText:"inactif",name:"reportRun",id:"reportRunU"+c.Id,state:c.rules.reportRun},{xtype:"toggleslidefield",fieldLabel:"Extraire les rapports PDF",onText:"actif",offText:"inactif",name:"reportExtractPDF",id:"reportExtractPDFU"+c.Id,state:c.rules.reportExtractPDF},{xtype:"toggleslidefield",fieldLabel:"Extraire les rapports Microsoft Word",onText:"actif",offText:"inactif",name:"reportExtractDOC",id:"reportExtractDOCU"+c.Id,state:c.rules.reportExtractDOC},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des rapports",onText:"actif",offText:"inactif",name:"reportDisplayLog",id:"reportDisplayLogU"+c.Id,state:c.rules.reportDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Tâches plannifiées",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux tâches plannifiée",onText:"actif",offText:"inactif",name:"planningDisplay",id:"planningDisplayU"+c.Id,state:c.rules.planningDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de tâches",onText:"actif",offText:"inactif",name:"planningGroupCreate",id:"planningGroupCreateU"+c.Id,state:c.rules.planningGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de tâches",onText:"actif",offText:"inactif",name:"planningGroupUpdate",id:"planningGroupUpdateU"+c.Id,state:c.rules.planningGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de tâches",onText:"actif",offText:"inactif",name:"planningGroupDelete",id:"planningGroupDeleteU"+c.Id,state:c.rules.planningGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des tâches",onText:"actif",offText:"inactif",name:"planningCreate",id:"planningCreateU"+c.Id,state:c.rules.planningCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des tâches",onText:"actif",offText:"inactif",name:"planningUpdate",id:"planningUpdateU"+c.Id,state:c.rules.planningUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des tâches",onText:"actif",offText:"inactif",name:"planningDelete",id:"planningDeleteU"+c.Id,state:c.rules.planningDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les tâches",onText:"actif",offText:"inactif",name:"planningForceDisplay",id:"planningForceDisplayU"+c.Id,state:c.rules.planningForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des tâches",onText:"actif",offText:"inactif",name:"planningDisplayLog",id:"planningDisplayLogU"+c.Id,state:c.rules.planningDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Utilisateurs",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux utilisateurs",onText:"actif",offText:"inactif",name:"userDisplay",id:"userDisplayU"+c.Id,state:c.rules.userDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupCreate",id:"userGroupCreateU"+c.Id,state:c.rules.userGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupUpdate",id:"userGroupUpdateU"+c.Id,state:c.rules.userGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupDelete",id:"userGroupDeleteU"+c.Id,state:c.rules.userGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des utilisateurs",onText:"actif",offText:"inactif",name:"userCreate",id:"userCreateU"+c.Id,state:c.rules.userCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des utilisateurs",onText:"actif",offText:"inactif",name:"userUpdate",id:"userUpdateU"+c.Id,state:c.rules.userUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des utilisateurs",onText:"actif",offText:"inactif",name:"userDelete",id:"userDeleteU"+c.Id,state:c.rules.userDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les utilisateurs",onText:"actif",offText:"inactif",name:"userForceDisplay",id:"userForceDisplayU"+c.Id,state:c.rules.userForceDisplay},{xtype:"textfield",fieldLabel:"Durée de session inactive",name:"sessionInactiveDelay",id:"sessionInactiveDelayU"+c.Id,value:b.raw.rules.sessionInactiveDelay},{xtype:"toggleslidefield",fieldLabel:"Désactiver les utilisateurs",onText:"actif",offText:"inactif",name:"userEnabled",id:"userEnabledU"+c.Id,state:c.rules.userEnabled},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des utilisateurs",onText:"actif",offText:"inactif",name:"userDisplayLog",id:"userDisplayLogU"+c.Id,state:c.rules.userDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Sources de données",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux sources de données",onText:"actif",offText:"inactif",name:"datasourceDisplay",id:"datasourceDisplayU"+c.Id,state:c.rules.datasourceDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupCreate",id:"datasourceGroupCreateU"+c.Id,state:c.rules.datasourceGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupUpdate",id:"datasourceGroupUpdateU"+c.Id,state:c.rules.datasourceGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupDelete",id:"datasourceGroupDeleteU"+c.Id,state:c.rules.datasourceGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des sources de données",onText:"actif",offText:"inactif",name:"datasourceCreate",id:"datasourceCreateU"+c.Id,state:c.rules.datasourceCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des sources de données",onText:"actif",offText:"inactif",name:"datasourceUpdate",id:"datasourceUpdateU"+c.Id,state:c.rules.datasourceUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des sources de données",onText:"actif",offText:"inactif",name:"datasourceDelete",id:"datasourceDeleteU"+c.Id,state:c.rules.datasourceDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les sources de données",onText:"actif",offText:"inactif",name:"datasourceForceDisplay",id:"datasourceForceDisplayU"+c.Id,state:c.rules.datasourceForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Autoriser le test des sources de données",onText:"actif",offText:"inactif",name:"datasourceTest",id:"datasourceTestU"+c.Id,state:c.rules.datasourceTest},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des sources de données",onText:"actif",offText:"inactif",name:"datasourceDisplayLog",id:"datasourceDisplayLogU"+c.Id,state:c.rules.datasourceDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Configurations",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux configurations",onText:"actif",offText:"inactif",name:"settingDisplay",id:"settingDisplayU"+c.Id,state:c.rules.settingDisplay},{xtype:"toggleslidefield",fieldLabel:"Modifier des configurations",onText:"actif",offText:"inactif",name:"settingUpdate",id:"settingUpdateU"+c.Id,state:c.rules.settingUpdate},{xtype:"toggleslidefield",fieldLabel:"Afficher toutes les logs",onText:"actif",offText:"inactif",name:"settingDisplayLog",id:"settingDisplayLogU"+c.Id,state:c.rules.settingDisplayLog},{xtype:"toggleslidefield",fieldLabel:"Autoriser la modification du mot de passe",onText:"actif",offText:"inactif",name:"settingPasswordCanChange",id:"settingPasswordCanChangeU"+c.Id,state:c.rules.settingPasswordCanChange}]}],closable:true,active:true,tbar:[{text:"Enregistrer",key:"save",handler:workspaceUsers.task}]});e.user=b.raw;e.rec=b;e.workspace=workspaceUsers;e.propertySource={"(name)":c.username,ldapusername:c.ldapusername,description:Ext.encode({description_resume:"",description_details:""}),motscles:"",environnement:"",nodek:"",publiee:true};centerPanel.add(e);centerPanel.setActiveTab(e)}a.hide()})},gotoUserGroup:function(a){workspaceUsers.getGroup(a.raw.Id,function(c){var b=false;centerPanel.items.each(function(f,e,g){if(f.group&&c.Id==f.group.Id){b=true;centerPanel.setActiveTab(f)}});if(!b){var d=Ext.create("Ext.Panel",{title:a.raw.text,iconCls:"icon-user",items:[{xtype:"panel",frame:true,title:"Accueil",bodyStyle:"padding: 10px;",style:"margin-bottom:10px;",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Afficher la page d'accueil",onText:"actif",offText:"inactif",name:"welcomeDisplay",id:"welcomeDisplayG"+c.Id,state:c.rules.welcomeDisplay},{xtype:"toggleslidefield",fieldLabel:"Afficher les états qui datent de plus de 5 jours",onText:"actif",offText:"inactif",name:"welcomeMoreFiveDays",id:"welcomeMoreFiveDaysG"+c.Id,state:c.rules.welcomeMoreFiveDays},{xtype:"toggleslidefield",fieldLabel:"Afficher le nombre de téléchargement",onText:"actif",offText:"inactif",name:"welcomeCountDownload",id:"welcomeCountDownloadG"+c.Id,state:c.rules.welcomeCountDownload}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Requêtes",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux requêtes",onText:"actif",offText:"inactif",name:"queryDisplay",id:"queryDisplayG"+c.Id,state:c.rules.queryDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de requêtes",onText:"actif",offText:"inactif",name:"queryGroupCreate",id:"queryGroupCreateG"+c.Id,state:c.rules.queryGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de requêtes",onText:"actif",offText:"inactif",name:"queryGroupUpdate",id:"queryGroupUpdateG"+c.Id,state:c.rules.queryGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de requêtes",onText:"actif",offText:"inactif",name:"queryGroupDelete",id:"queryGroupDeleteG"+c.Id,state:c.rules.queryGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des requêtes",onText:"actif",offText:"inactif",name:"queryCreate",id:"queryCreateG"+c.Id,state:c.rules.queryCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des requêtes",onText:"actif",offText:"inactif",name:"queryUpdate",id:"queryUpdateG"+c.Id,state:c.rules.queryUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des requêtes",onText:"actif",offText:"inactif",name:"queryDelete",id:"queryDeleteG"+c.Id,state:c.rules.queryDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les requêtes",onText:"actif",offText:"inactif",name:"queryForceDisplay",id:"queryForceDisplayG"+c.Id,state:c.rules.queryForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Exécution des requêtes",onText:"actif",offText:"inactif",name:"queryRun",id:"queryRunG"+c.Id,state:c.rules.queryRun},{xtype:"toggleslidefield",fieldLabel:"Extraire les requêtes CSV",onText:"actif",offText:"inactif",name:"queryExtractCSV",id:"queryExtractCSVG"+c.Id,state:c.rules.queryExtractCSV},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des requêtes",onText:"actif",offText:"inactif",name:"queryDisplayLog",id:"queryDisplayLogG"+c.Id,state:c.rules.queryDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Rapports",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux rapports",onText:"actif",offText:"inactif",name:"reportDisplay",id:"reportDisplayG"+c.Id,state:c.rules.reportDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de rapports",onText:"actif",offText:"inactif",name:"reportGroupCreate",id:"reportGroupCreateG"+c.Id,state:c.rules.reportGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de rapports",onText:"actif",offText:"inactif",name:"reportGroupUpdate",id:"reportGroupUpdateG"+c.Id,state:c.rules.reportGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de rapports",onText:"actif",offText:"inactif",name:"reportGroupDelete",id:"reportGroupDeleteG"+c.Id,state:c.rules.reportGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des rapports",onText:"actif",offText:"inactif",name:"reportCreate",id:"reportCreateG"+c.Id,state:c.rules.reportCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des rapports",onText:"actif",offText:"inactif",name:"reportUpdate",id:"reportUpdateG"+c.Id,state:c.rules.reportUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des rapports",onText:"actif",offText:"inactif",name:"reportDelete",id:"reportDeleteG"+c.Id,state:c.rules.reportDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les rapports",onText:"actif",offText:"inactif",name:"reportForceDisplay",id:"reportForceDisplayG"+c.Id,state:c.rules.reportForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Exécuter les rapports",onText:"actif",offText:"inactif",name:"reportRun",id:"reportRunG"+c.Id,state:c.rules.reportRun},{xtype:"toggleslidefield",fieldLabel:"Extraire les rapports PDF",onText:"actif",offText:"inactif",name:"reportExtractPDF",id:"reportExtractPDFG"+c.Id,state:c.rules.reportExtractPDF},{xtype:"toggleslidefield",fieldLabel:"Extraire les rapports Microsoft Word",onText:"actif",offText:"inactif",name:"reportExtractDOC",id:"reportExtractDOCG"+c.Id,state:c.rules.reportExtractDOC},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des rapports",onText:"actif",offText:"inactif",name:"reportDisplayLog",id:"reportDisplayLogG"+c.Id,state:c.rules.reportDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Tâches plannifiées",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux tâches plannifiée",onText:"actif",offText:"inactif",name:"planningDisplay",id:"planningDisplayG"+c.Id,state:c.rules.planningDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de tâches",onText:"actif",offText:"inactif",name:"planningGroupCreate",id:"planningGroupCreateG"+c.Id,state:c.rules.planningGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de tâches",onText:"actif",offText:"inactif",name:"planningGroupUpdate",id:"planningGroupUpdateG"+c.Id,state:c.rules.planningGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de tâches",onText:"actif",offText:"inactif",name:"planningGroupDelete",id:"planningGroupDeleteG"+c.Id,state:c.rules.planningGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des tâches",onText:"actif",offText:"inactif",name:"planningCreate",id:"planningCreateG"+c.Id,state:c.rules.planningCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des tâches",onText:"actif",offText:"inactif",name:"planningUpdate",id:"planningUpdateG"+c.Id,state:c.rules.planningUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des tâches",onText:"actif",offText:"inactif",name:"planningDelete",id:"planningDeleteG"+c.Id,state:c.rules.planningDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les tâches",onText:"actif",offText:"inactif",name:"planningForceDisplay",id:"planningForceDisplayG"+c.Id,state:c.rules.planningForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des tâches",onText:"actif",offText:"inactif",name:"planningDisplayLog",id:"planningDisplayLogG"+c.Id,state:c.rules.planningDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Utilisateurs",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux utilisateurs",onText:"actif",offText:"inactif",name:"userDisplay",id:"userDisplayG"+c.Id,state:c.rules.userDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupCreate",id:"userGroupCreateG"+c.Id,state:c.rules.userGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupUpdate",id:"userGroupUpdateG"+c.Id,state:c.rules.userGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de utilisateurs",onText:"actif",offText:"inactif",name:"userGroupDelete",id:"userGroupDeleteG"+c.Id,state:c.rules.userGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des utilisateurs",onText:"actif",offText:"inactif",name:"userCreate",id:"userCreateG"+c.Id,state:c.rules.userCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des utilisateurs",onText:"actif",offText:"inactif",name:"userUpdate",id:"userUpdateG"+c.Id,state:c.rules.userUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des utilisateurs",onText:"actif",offText:"inactif",name:"userDelete",id:"userDeleteG"+c.Id,state:c.rules.userDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les utilisateurs",onText:"actif",offText:"inactif",name:"userForceDisplay",id:"userForceDisplayG"+c.Id,state:c.rules.userForceDisplay},{xtype:"textfield",fieldLabel:"Durée de session inactive",name:"sessionInactiveDelay",id:"sessionInactiveDelayG"+c.Id,value:a.raw.rules.sessionInactiveDelay},{xtype:"toggleslidefield",fieldLabel:"Désactiver les utilisateurs",onText:"actif",offText:"inactif",name:"userEnabled",id:"userEnabledG"+c.Id,state:c.rules.userEnabled},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des utilisateurs",onText:"actif",offText:"inactif",name:"userDisplayLog",id:"userDisplayLogG"+c.Id,state:c.rules.userDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Sources de données",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux sources de données",onText:"actif",offText:"inactif",name:"datasourceDisplay",id:"datasourceDisplayG"+c.Id,state:c.rules.datasourceDisplay},{xtype:"toggleslidefield",fieldLabel:"Créer des groupe de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupCreate",id:"datasourceGroupCreateG"+c.Id,state:c.rules.datasourceGroupCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des groupes de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupUpdate",id:"datasourceGroupUpdateG"+c.Id,state:c.rules.datasourceGroupUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des groupes de sources de données",onText:"actif",offText:"inactif",name:"datasourceGroupDelete",id:"datasourceGroupDeleteG"+c.Id,state:c.rules.datasourceGroupDelete},{xtype:"toggleslidefield",fieldLabel:"Créer des sources de données",onText:"actif",offText:"inactif",name:"datasourceCreate",id:"datasourceCreateG"+c.Id,state:c.rules.datasourceCreate},{xtype:"toggleslidefield",fieldLabel:"Modifier des sources de données",onText:"actif",offText:"inactif",name:"datasourceUpdate",id:"datasourceUpdateG"+c.Id,state:c.rules.datasourceUpdate},{xtype:"toggleslidefield",fieldLabel:"Supprimer des sources de données",onText:"actif",offText:"inactif",name:"datasourceDelete",id:"datasourceDeleteG"+c.Id,state:c.rules.datasourceDelete},{xtype:"toggleslidefield",fieldLabel:"Forcer l'affichage de toutes les sources de données",onText:"actif",offText:"inactif",name:"datasourceForceDisplay",id:"datasourceForceDisplayG"+c.Id,state:c.rules.datasourceForceDisplay},{xtype:"toggleslidefield",fieldLabel:"Autoriser le test des sources de données",onText:"actif",offText:"inactif",name:"datasourceTest",id:"datasourceTestG"+c.Id,state:c.rules.datasourceTest},{xtype:"toggleslidefield",fieldLabel:"Afficher les logs des sources de données",onText:"actif",offText:"inactif",name:"datasourceDisplayLog",id:"datasourceDisplayLogG"+c.Id,state:c.rules.datasourceDisplayLog}]},{xtype:"panel",frame:true,style:"margin-bottom:10px;",title:"Configurations",bodyStyle:"padding: 10px",cls:"subform",items:[{xtype:"toggleslidefield",fieldLabel:"Accès aux configurations",onText:"actif",offText:"inactif",name:"settingDisplay",id:"settingDisplayG"+c.Id,state:c.rules.settingDisplay},{xtype:"toggleslidefield",fieldLabel:"Modifier des configurations",onText:"actif",offText:"inactif",name:"settingUpdate",id:"settingUpdateG"+c.Id,state:c.rules.settingUpdate},{xtype:"toggleslidefield",fieldLabel:"Afficher toutes les logs",onText:"actif",offText:"inactif",name:"settingDisplayLog",id:"settingDisplayLogG"+c.Id,state:c.rules.settingDisplayLog},{xtype:"toggleslidefield",fieldLabel:"Autoriser la modification du mot de passe",onText:"actif",offText:"inactif",name:"settingPasswordCanChange",id:"settingPasswordCanChangeG"+c.Id,state:c.rules.settingPasswordCanChange}]}],closable:true,active:true,tbar:[{text:"Enregistrer",key:"save",handler:workspaceUsers.task},{text:"Forcer l'application sur les utilisateurs",key:"apply",handler:workspaceUsers.task}]});d.group=a.raw;d.rec=a;d.workspace=workspaceUsers;d.propertySource={"(name)":c.title,ldapusername:c.title,description:Ext.encode({description_resume:"",description_details:""}),motscles:"",environnement:"",nodek:"",publiee:true};centerPanel.add(d);centerPanel.setActiveTab(d)}})},onCenterTabChange:function(b,a){if("user" in a){workspaceUsers.current=a.user;workspaceUsers.propertyData.setSource(a.propertySource)}},itemUsers:Ext.create("Ext.tree.Panel",{title:"Utilisateurs",store:Ext.create("Ext.data.TreeStore",{model:"treeModel",proxy:{type:"memory"}}),viewConfig:{plugins:{ptype:"treeviewdragdrop"},listeners:{beforedrop:function(d,f,e,b,a,c){if((b=="before"||b=="after")&&e.parentNode.raw.text=="Root"){if(f.records[0].raw.nodek=="user"){a.cancelDrop()}}},drop:function(c,e,d,b){if(e.records[0].raw.nodek=="groupuser"){var f={id:e.records[0].raw.Id,groupid:d.raw.Id};symfony("save","group","user",f,function(g){})}else{if(e.records[0].raw.nodek=="user"){var a={id:e.records[0].raw.Id,groupid:d.raw.Id};symfony("save","user","user",a,function(g){if(workspaceUsers.current.Id==a.id){workspaceUsers.current.groupid=a.groupid}})}}}}},rootVisible:false,listeners:{afterrender:function(a,b){var c=new Ext.LoadMask(workspaceUsers.itemUsers,{msg:"Veuillez patienter ..."});c.show();symfony("list","user","user",{},function(d){var f=workspaceUsers.itemUsers.getStore();var e=f.setRootNode({children:d.data});Ext.apply(workspaceUsers.itemUsers,{store:f});c.hide()})},itemdblclick:function(b,e,d,c,a){if(e.get("leaf")){workspaceUsers.gotoUser(e)}},containercontextmenu:function(b,a){workspaceUsers.menuGroupUsers.rec=workspaceUsers.itemUsers.store.tree.root;workspaceUsers.menuRootGroupUsers.showAt(a.getXY());a.stopEvent()},itemcontextmenu:function(b,e,d,c,a){if(e.get("leaf")){workspaceUsers.menuUsers.rec=e;workspaceUsers.menuUsers.showAt(a.getXY())}else{Ext.getCmp("userdelete").setDisabled(false);if(e.raw.persist){Ext.getCmp("userdelete").setDisabled(true)}workspaceUsers.menuGroupUsers.rec=e;workspaceUsers.menuGroupUsers.showAt(a.getXY())}a.stopEvent()}}}),setProperties:function(a){$.each(a,function(b,c){workspaceUsers.propertySource[b]=c});workspaceUsers.propertyData.setSource(workspaceUsers.propertySource)},set:function(b,d){currentWorkspace=workspaceUsers;bottomPanel.hide();propertyPanel.removeAll();workspaceUsers.propertySource={"(name)":"name",ldapusername:"",description:Ext.encode({description_resume:"",description_details:""}),motscles:"",environnement:"",nodek:"",publiee:true};workspaceUsers.propertyData=Ext.create("Ext.grid.property.Grid",{title:"Propriétés",propertyNames:{"(name)":"(Nom)",ldapusername:"LDAP",description:"Description",motscles:"Mots clés",environnement:"Environnement",nodek:"Groupe",publiee:"Publiée"},listeners:{propertychange:function(k,h,j,g){if(h=="(name)"){var i=centerPanel.getActiveTab();i.rec.set("text",j);i.rec.raw.text=j;i.rec.raw.username=j;i.rec.commit();i.setTitle(j)}}},customEditors:{description:{xtype:"descriptionfield"},groupe:{xtype:"combobox"},environnement:{xtype:"combobox"}},customRenderers:{description:function(g){var j=Ext.decode(g),k=j.description_details,h=j.description_resume,i="";i+="<b>"+h+"</b>: ";i+="<i>"+k+"</i>";return i}},source:workspaceUsers.propertySource});propertyPanel.add(workspaceUsers.propertyData);propertyPanel.add(aboutTab());propertyPanel.setActiveTab(workspaceUsers.propertyData);var f=Ext.create("Ext.grid.Panel",{columnLines:true,columns:[{text:"Ordre",flex:1,sortable:1},{text:"Nom SQL",flex:1,sortable:1},{text:"Titre de la colonne",flex:1,sortable:1},{text:"Cadrage",flex:1,sortable:1},{text:"Format de date",flex:1,sortable:1},{text:"Largeur de la colonne",flex:1,sortable:1}]});var e=Ext.create("Ext.grid.Panel",{columnLines:true,columns:[{text:"Ordre",flex:1,sortable:1},{text:"Nom SQL",flex:1,sortable:1}]});bottomPanel.removeAll();var c=Ext.create("Ext.Panel",{title:"Paramètres d'affichage des colonnes",iconCls:"tabs",closable:false,items:[f]});var a=Ext.create("Ext.Panel",{title:"Résultats utilisateurs",iconCls:"tabs",html:"center south",closable:false,items:[e]});bottomPanel.add(c);bottomPanel.add(a);bottomPanel.setActiveTab(c);d()},getUser:function(b,a){symfony("get","user","user",{id:b},function(c){if(workspaceUsers.users[c.data.Id]===undefined){workspaceUsers.users[c.data.Id]={}}a(c.data)})},getGroup:function(b,a){symfony("get","group","user",{id:b},function(c){if(workspaceUsers.groups[c.data.Id]===undefined){workspaceUsers.groups[c.data.Id]={}}a(c.data)})},task:function(a){switch(a.key){case"save":var b=centerPanel.getActiveTab();var g="G";if(b.rec.raw.nodek=="user"){g="U"}var i=b.rec.raw.Id;var h={welcomeDisplay:Ext.getCmp("welcomeDisplay"+g+i).value,welcomeMoreFiveDays:Ext.getCmp("welcomeMoreFiveDays"+g+i).value,welcomeCountDownload:Ext.getCmp("welcomeCountDownload"+g+i).value,queryDisplay:Ext.getCmp("queryDisplay"+g+i).value,queryCreate:Ext.getCmp("queryCreate"+g+i).value,queryUpdate:Ext.getCmp("queryUpdate"+g+i).value,queryDelete:Ext.getCmp("queryDelete"+g+i).value,queryGroupCreate:Ext.getCmp("queryGroupCreate"+g+i).value,queryGroupUpdate:Ext.getCmp("queryGroupUpdate"+g+i).value,queryGroupDelete:Ext.getCmp("queryGroupDelete"+g+i).value,queryForceDisplay:Ext.getCmp("queryForceDisplay"+g+i).value,reportDisplay:Ext.getCmp("reportDisplay"+g+i).value,reportCreate:Ext.getCmp("reportCreate"+g+i).value,reportUpdate:Ext.getCmp("reportUpdate"+g+i).value,reportDelete:Ext.getCmp("reportDelete"+g+i).value,reportGroupCreate:Ext.getCmp("reportGroupCreate"+g+i).value,reportGroupUpdate:Ext.getCmp("reportGroupUpdate"+g+i).value,reportGroupDelete:Ext.getCmp("reportGroupDelete"+g+i).value,reportForceDisplay:Ext.getCmp("reportForceDisplay"+g+i).value,planningDisplay:Ext.getCmp("planningDisplay"+g+i).value,planningCreate:Ext.getCmp("planningCreate"+g+i).value,planningUpdate:Ext.getCmp("planningUpdate"+g+i).value,planningDelete:Ext.getCmp("planningDelete"+g+i).value,planningGroupCreate:Ext.getCmp("planningGroupCreate"+g+i).value,planningGroupUpdate:Ext.getCmp("planningGroupUpdate"+g+i).value,planningGroupDelete:Ext.getCmp("planningGroupDelete"+g+i).value,planningForceDisplay:Ext.getCmp("planningForceDisplay"+g+i).value,userDisplay:Ext.getCmp("userDisplay"+g+i).value,userCreate:Ext.getCmp("userCreate"+g+i).value,userUpdate:Ext.getCmp("userUpdate"+g+i).value,userDelete:Ext.getCmp("userDelete"+g+i).value,userGroupCreate:Ext.getCmp("userGroupCreate"+g+i).value,userGroupUpdate:Ext.getCmp("userGroupUpdate"+g+i).value,userGroupDelete:Ext.getCmp("userGroupDelete"+g+i).value,userForceDisplay:Ext.getCmp("userForceDisplay"+g+i).value,datasourceDisplay:Ext.getCmp("datasourceDisplay"+g+i).value,datasourceCreate:Ext.getCmp("datasourceCreate"+g+i).value,datasourceUpdate:Ext.getCmp("datasourceUpdate"+g+i).value,datasourceDelete:Ext.getCmp("datasourceDelete"+g+i).value,datasourceGroupCreate:Ext.getCmp("datasourceGroupCreate"+g+i).value,datasourceGroupUpdate:Ext.getCmp("datasourceGroupUpdate"+g+i).value,datasourceGroupDelete:Ext.getCmp("datasourceGroupDelete"+g+i).value,datasourceForceDisplay:Ext.getCmp("datasourceForceDisplay"+g+i).value,settingDisplay:Ext.getCmp("settingDisplay"+g+i).value,settingUpdate:Ext.getCmp("settingUpdate"+g+i).value,queryRun:Ext.getCmp("queryRun"+g+i).value,reportRun:Ext.getCmp("reportRun"+g+i).value,userEnabled:Ext.getCmp("userEnabled"+g+i).value,queryExtractCSV:Ext.getCmp("queryExtractCSV"+g+i).value,reportExtractPDF:Ext.getCmp("reportExtractPDF"+g+i).value,reportExtractDOC:Ext.getCmp("reportExtractDOC"+g+i).value,datasourceTest:Ext.getCmp("datasourceTest"+g+i).value,datasourceDisplayLog:Ext.getCmp("datasourceDisplayLog"+g+i).value,queryDisplayLog:Ext.getCmp("queryDisplayLog"+g+i).value,reportDisplayLog:Ext.getCmp("reportDisplayLog"+g+i).value,planningDisplayLog:Ext.getCmp("planningDisplayLog"+g+i).value,userDisplayLog:Ext.getCmp("userDisplayLog"+g+i).value,settingDisplayLog:Ext.getCmp("settingDisplayLog"+g+i).value,sessionInactiveDelay:Ext.getCmp("sessionInactiveDelay"+g+i).value,settingPasswordCanChange:Ext.getCmp("settingPasswordCanChange"+g+i).value,userid:(g=="U")?i:0,usergroupid:(g=="G")?i:0};var e={};var f="";if(g=="G"){e={id:i,rules:h};f="group"}if(g=="U"){var d=workspaceUsers.propertyData.source["(name)"];workspaceUsers.current.username=d;workspaceUsers.current.ldapusername=workspaceUsers.propertyData.source.ldapusername;e={id:workspaceUsers.current.Id,username:workspaceUsers.current.username,ldapusername:workspaceUsers.current.ldapusername,groupid:workspaceUsers.current.groupid,rules:h};f="user"}var c=new Ext.LoadMask(centerPanel,{msg:"Sauvegarde en cours ..."});c.show();symfony("save",f,"user",e,function(j){c.hide()});break}}};