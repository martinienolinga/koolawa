var globalSpreadbox=[];function initSpreadBoxAction(){$(document).on("mousemove",function(b){var a=workspace.spreadsheetpanel.current;globalSpreadbox[a].mousemove(b,a)});$(document).on("mousedown",function(b){var a=workspace.spreadsheetpanel.current;globalSpreadbox[a].mousedown(b,a)});$(document).on("mouseup",function(b){var a=workspace.spreadsheetpanel.current;globalSpreadbox[a].mouseup(b,a)})}function initSpreadBox(a){globalSpreadbox[a]={};globalSpreadbox[a].sheet=$("#sheet_"+a);globalSpreadbox[a].sheetEl=document.getElementById("sheet_"+a);globalSpreadbox[a].spreadbox=$("#spreadbox_"+a);globalSpreadbox[a].spreadboxEl=document.getElementById("spreadbox_"+a);globalSpreadbox[a].tabfeuilleBody=globalSpreadbox[a].spreadbox.parent().parent().parent();globalSpreadbox[a].functiondiv=$("#functiondiv_"+a);globalSpreadbox[a].functionvalue=$("#functionvalue_"+a);globalSpreadbox[a].functionvalueEl=document.getElementById("functionvalue_"+a);globalSpreadbox[a].textarea=globalSpreadbox[a].functionvalue.find("textarea");globalSpreadbox[a].functionEditor=CodeMirror.fromTextArea(globalSpreadbox[a].textarea.get()[0],{matchBrackets:true,extraKeys:{Tab:"indentAuto"}});globalSpreadbox[a].functionEditor.setOption("mode","text/x-spreadsheet");globalSpreadbox[a].functionEditorDiv=globalSpreadbox[a].functionvalue.find(".CodeMirror");globalSpreadbox[a].functionEditor.on("beforeChange",function(b,d){document.title=d.text;var c=d.text.join("").replace(/\n/g,"");d.update(d.from,d.to,[c]);return true});globalSpreadbox[a].functionEditor.on("change",function(b,c){globalSpreadbox[a].functionEditorDiv.find(".CodeMirror-hscrollbar").css("display","none")});globalSpreadbox[a].functionEditorDiv.find(".CodeMirror-scroll").css("overflow","hidden");globalSpreadbox[a].rowshead=[];globalSpreadbox[a].columnshead=[];globalSpreadbox[a].cells=[];globalSpreadbox[a].rowsline=[];globalSpreadbox[a].cellseditable=[];globalSpreadbox[a].resizerowboxDown=null;globalSpreadbox[a].resizerowboxY=0;globalSpreadbox[a].resizecolumnboxDown=null;globalSpreadbox[a].resizecolumnboxX=0;globalSpreadbox[a].sizeHztdiv=0;globalSpreadbox[a].sizeVrtdiv=0;globalSpreadbox[a].sizeableIndex=0;globalSpreadbox[a].horizontalSlide=0;globalSpreadbox[a].slideLeftToCellID=0;globalSpreadbox[a].verticalSlide=0;globalSpreadbox[a].slideTopToCellID=0;globalSpreadbox[a].firstcell=null;globalSpreadbox[a].secondcell=null;globalSpreadbox[a].sheetMouseDown=false;globalSpreadbox[a].selectedcell=null;globalSpreadbox[a].sheetBarreTop=false;globalSpreadbox[a].sheetBarreLeft=false;globalSpreadbox[a].columnselected=[];globalSpreadbox[a].rowselected=[];globalSpreadbox[a].SX=0;globalSpreadbox[a].SY=0;globalSpreadbox[a].sheetScrolled=0;globalSpreadbox[a].visibleCells=[];globalSpreadbox[a].sheetEl.scrollTopFixe=0;resizeSpreadBox(a);globalSpreadbox[a].functionvalue.on("input",function(b){var g=globalSpreadbox[a].selectedcell;var h=g.attr("address");if(typeof globalSpreadbox[a].cellseditable[h]==="undefined"){var f=h.split(" ");var k=parseInt(f[1])-1;var d=parseInt(f[0]);var e=globalSpreadbox[a].cells[d][k].editable;globalSpreadbox[a].sheet.prepend(e);e.isvisible=true;e.width(g.width());e.height(g.height());e.css("marginTop","-"+g.height()+"px");var c=g.offset().left;var j=g.offset().top;e.offset({left:c,top:j});globalSpreadbox[a].cellseditable[h]=e}var e=globalSpreadbox[a].cellseditable[h];e.html(globalSpreadbox[a].functionvalue.html())});globalSpreadbox[a].functionvalue.on("focus",function(){globalSpreadbox[a].functionvalue.toggleClass("focus")});globalSpreadbox[a].functionvalue.on("blur",function(){globalSpreadbox[a].functionvalue.toggleClass("focus")});globalSpreadbox[a].selector1=$("<div/>",{id:"selector1_"+a,"class":"selector1"});globalSpreadbox[a].selector1.css("visibility","hidden");globalSpreadbox[a].selector3=$("<div/>",{id:"selector3_"+a,"class":"selector3"});globalSpreadbox[a].selector3.css("visibility","hidden");globalSpreadbox[a].selector2=$("<div/>",{id:"selector2_"+a,"class":"selector2"});globalSpreadbox[a].selector2.css("visibility","hidden");globalSpreadbox[a].sizeableVrtdiv=$("<div/>",{id:"sizeableVrtdiv_"+a,"class":"sizeableVrtdiv"});globalSpreadbox[a].sizeableVrtdiv.css("marginTop","-"+(globalSpreadbox[a].spreadbox.height())+"px");globalSpreadbox[a].sizeableVrtdiv.html("<div></div>");globalSpreadbox[a].sizeableHztdiv=$("<div/>",{id:"sizeableHztdiv_"+a,"class":"sizeableHztdiv"});globalSpreadbox[a].sizeableHztdiv.css("top","-"+(globalSpreadbox[a].spreadbox.height()-5)+"px");globalSpreadbox[a].sizeableHztdiv.html("<div></div>");$("#spreadboxline2_"+a).height(globalSpreadbox[a].sheet.height());$("#sheet_"+a).on("scroll",function(b){$("#columnsbox_"+a).get()[0].scrollLeft=globalSpreadbox[a].sheetEl.scrollLeft;$("#rowsbox_"+a).get()[0].scrollTop=globalSpreadbox[a].sheetEl.scrollTop;if(isFirefox){if(globalSpreadbox[a].sheetEl.scrollTop==(globalSpreadbox[a].sheetEl.scrollHeight-globalSpreadbox[a].sheetEl.clientHeight)){globalSpreadbox[a].sheetEl.scrollTopFixe=-1}if(globalSpreadbox[a].sheetEl.scrollTop==0&&globalSpreadbox[a].sheetEl.scrollTopFixe!=0){globalSpreadbox[a].sheetEl.scrollTopFixe=0}}$("#rowsbox_"+a).get()[0].scrollTop+=globalSpreadbox[a].sheetEl.scrollTopFixe;globalSpreadbox[a].getVisiblesCells(a)});$("#sheet_"+a).append(globalSpreadbox[a].selector1);$("#sheet_"+a).append(globalSpreadbox[a].selector2);$("#sheet_"+a).append(globalSpreadbox[a].selector3);$("#spreadbox_"+a).append(globalSpreadbox[a].sizeableHztdiv);$("#spreadbox_"+a).append(globalSpreadbox[a].sizeableVrtdiv);globalSpreadbox[a].addmatrix=function(r,d,e){var k=globalSpreadbox[e].sheet.find(".rowhead").size();var b=$("#rowsbox_"+e+" > div");for(i=0;i<r;i++){rindex=k+i+1;rsizeh=20;var f=$("<div/>",{"class":"rowhead head",kind:"header"});f.attr("index",rindex);f.height(rsizeh);f.attr("sizeh",rsizeh);globalSpreadbox[e].rowshead[rindex]=f;globalSpreadbox[e].cells[rindex-1]=[];var l=$("<div/>",{"class":"contentrowbox"});l.css("height",rsizeh+"px");l.html(rindex);var m=$("<div/>",{"class":"resizerowbox"});m.attr("index",rindex);m.on("mousedown",function(t){if(globalSpreadbox[e].resizerowboxDown==null){globalSpreadbox[e].sizeableHztdiv.css("display","block");var s=$(this).offset().top;globalSpreadbox[e].sizeableHztdiv.width(globalSpreadbox[e].tabfeuilleBody.width());globalSpreadbox[e].sizeableHztdiv.offset({top:s});globalSpreadbox[e].resizerowboxY=s;globalSpreadbox[e].resizerowboxDown=t.pageY;globalSpreadbox[e].sizeableIndex=parseInt($(t.target).attr("index"))}});f.append(l);f.append(m);b.append(f);var q=$("<div/>",{"class":"row"});q.attr("index",rindex);q.height(rsizeh);q.attr("sizeh",rsizeh);q.get()[0].head=f;globalSpreadbox[e].rowsline[rindex]=q;globalSpreadbox[e].sheet.append(q)}var h=b.height()+100;b.height(h);var g=globalSpreadbox[e].sheet.find(".columnhead").size();var o=$("#columnsbox_"+e+" > div");var p=o.width();if(g==0){p=100}for(i=0;i<d;i++){cindex=g+i+1;csizew=100;var n=$("<div/>",{"class":"columnhead head",kind:"header"});n.attr("index",cindex);n.width(csizew);n.attr("sizew",csizew);globalSpreadbox[e].columnshead[cindex]=n;var c=$("<div/>",{"class":"contentcolumnbox"});c.css("width",(csizew-5)+"px");c.html(String.fromCharCode(64+cindex));var j=$("<div/>",{"class":"resizecolumnbox"});j.attr("index",cindex);j.on("mousedown",function(t){if(globalSpreadbox[e].resizecolumnboxDown==null){globalSpreadbox[e].sizeableVrtdiv.css("display","block");var s=$(this).offset().left;globalSpreadbox[e].sizeableVrtdiv.height(globalSpreadbox[e].tabfeuilleBody.height()-globalSpreadbox[e].functiondiv.get()[0].offsetHeight);globalSpreadbox[e].sizeableVrtdiv.offset({left:s});globalSpreadbox[e].resizecolumnboxX=s;globalSpreadbox[e].resizecolumnboxDown=t.pageX;globalSpreadbox[e].sizeableIndex=parseInt($(t.target).attr("index"))}});n.append(c);n.append(j);o.append(n);p+=csizew;$("#sheet_"+e+" .row").each(function(t){var u=$(this).height();var s=$("<div/>",{"class":"cell"});s.width(csizew);s.height(u);s.attr("sizew",csizew);s.attr("sizeh",u);s.get()[0].column=n;s.get()[0].row=this.head;s.attr("address",t+" "+cindex);s.attr("addresscell",String.fromCharCode(64+cindex)+(t+1));s.attr("addressrow",(t+1));s.attr("addresscolumn",String.fromCharCode(64+cindex));s.editable=$("<div>",{"class":"celleditable"});s.editable.isvisible=false;globalSpreadbox[e].cells[t][cindex-1]=s;$(this).append(s)})}o.width(p)};globalSpreadbox[a].slideLeftToCell=function(b,c){if(globalSpreadbox[c].sheetMouseDown&&globalSpreadbox[c].sheetBarreLeft&&globalSpreadbox[c].slideLeftToCellID==0){globalSpreadbox[c].slideLeftToCellID=setInterval(function(){globalSpreadbox[c].sheetEl.scrollLeft+=globalSpreadbox[c].horizontalSlide*10},1)}};globalSpreadbox[a].slideTopToCell=function(b,c){if(globalSpreadbox[c].sheetMouseDown&&globalSpreadbox[c].sheetBarreTop&&globalSpreadbox[c].slideTopToCellID==0){globalSpreadbox[c].slideTopToCellID=setInterval(function(){globalSpreadbox[c].sheetEl.scrollTop+=globalSpreadbox[c].verticalSlide*10},1)}};globalSpreadbox[a].stopSlideLeft=function(b){clearInterval(globalSpreadbox[b].slideLeftToCellID);globalSpreadbox[b].slideLeftToCellID=0};globalSpreadbox[a].stopSlideTop=function(b){clearInterval(globalSpreadbox[b].slideTopToCellID);globalSpreadbox[b].slideTopToCellID=0};globalSpreadbox[a].getCellFromCursor=function(h,f){var j=null;for(var d=0;d<globalSpreadbox[f].visibleCells.length;d++){var k=globalSpreadbox[f].visibleCells[d];var b=$(k).offset().left;var l=$(k).offset().top;var g=k.offsetWidth;var c=k.offsetHeight;if((h.pageX>=b&&h.pageX<=b+g)&&(h.pageY>=l&&h.pageY<=l+c)){j=k;break}}return j};globalSpreadbox[a].mousedown=function(g,b){var d=globalSpreadbox[b].tabfeuilleBody;var c=globalSpreadbox[b].sheet;if((g.pageX<d.offset().left)||(g.pageY<d.offset().top)||((g.pageX>d.offset().left+50)&&(g.pageY>c.offset().top+c.get()[0].clientHeight))||((g.pageY>d.offset().top+20)&&(g.pageX>c.offset().left+c.get()[0].clientWidth))){return}globalSpreadbox[b].sheetMouseDown=true;var f=globalSpreadbox[b].getCellFromCursor(g,b);if(f==null){return}if($(f).hasClass("cell")){if((globalSpreadbox[b].resizecolumnboxDown==null)&&(globalSpreadbox[b].resizerowboxDown==null)){globalSpreadbox[b].selector2.css("visibility","hidden");globalSpreadbox[b].selector2.removeClass("selector2_border");globalSpreadbox[b].selector3.css("visibility","hidden");if(globalSpreadbox[b].selector1.css("visibility")==="hidden"){globalSpreadbox[b].selector1.css("visibility","visible")}cell=$(f);globalSpreadbox[b].positionSelector(cell,b);globalSpreadbox[b].positionSelection(globalSpreadbox[b].firstcell,cell,b)}}if(typeof f.id!==typeof undefined&&f.id==="selector1_"+b){globalSpreadbox[b].firstcell=globalSpreadbox[b].selector1.cell}};globalSpreadbox[a].positionSelector=function(b,d){if(b!=null){$("#selectedcell_"+d).html(b.attr("addresscell"));globalSpreadbox[d].firstcell=b;globalSpreadbox[d].selector1.cell=b;globalSpreadbox[d].selectedcell=b;var g=b.attr("address").split(" ");var f=parseInt(g[1])-1;var c=parseInt(g[0]);var e=globalSpreadbox[d].cells[c][f].editable;globalSpreadbox[d].selector1.css("width",(b.width()+4-1)+"px");globalSpreadbox[d].selector1.css("height",(b.height()+4)+"px");globalSpreadbox[d].selector1.css("marginTop","-"+(globalSpreadbox[d].selector1.height()+6)+"px");globalSpreadbox[d].selector1.offset({top:(b.offset().top-2),left:(b.offset().left-2)})}};globalSpreadbox[a].updateCmpEditable=function(d){for(var c=0;c<globalSpreadbox[d].cells.length;c++){for(var f=0;f<globalSpreadbox[d].cells[c].length;f++){var b=globalSpreadbox[d].cells[c][f];var e=b.editable;if(e.isvisible){e.width(b.width());e.height(b.height());e.css("marginTop","-"+b.height()+"px");e.offset({left:b.offset().left,top:b.offset().top})}}}};globalSpreadbox[a].mouseup=function(k,g){clearInterval(globalSpreadbox[g].slideLeftToCellID);clearInterval(globalSpreadbox[g].slideTopToCellID);globalSpreadbox[g].slideLeftToCellID=0;globalSpreadbox[g].slideTopToCellID=0;if(globalSpreadbox[g].resizecolumnboxDown!=null){var b=globalSpreadbox[g].columnshead[globalSpreadbox[g].sizeableIndex];var l=b.width()+globalSpreadbox[g].sizeVrtdiv;if(l<10){l=10}b.width(l);b.find(".contentcolumnbox").css("width",(b.width()-5)+"px");var n=parseInt(b.attr("index"));for(var f=0;f<globalSpreadbox[g].cells.length;f++){globalSpreadbox[g].cells[f][n-1].width(b.width())}globalSpreadbox[g].sizeVrtdiv=0;globalSpreadbox[g].updateCmpEditable(g);if(globalSpreadbox[g].selector2.cell1!=null){globalSpreadbox[g].positionSelector(globalSpreadbox[g].selector2.cell1,g);globalSpreadbox[g].positionSelection(globalSpreadbox[g].selector2.cell1,globalSpreadbox[g].selector2.cell2,g);globalSpreadbox[g].selector3.offset({top:globalSpreadbox[g].SY,left:globalSpreadbox[g].SX})}}if(globalSpreadbox[g].resizerowboxDown!=null){var j=globalSpreadbox[g].rowshead[globalSpreadbox[g].sizeableIndex];var d=j.height()+globalSpreadbox[g].sizeHztdiv;if(d<10){d=10}j.height(d);var c=j.height()+"px";var m=j.height()+"px";j.find(".contentrowbox").css("height",c);j.find(".contentrowbox").css("line-height",c);var h=parseInt(j.attr("index"));globalSpreadbox[g].rowsline[h].css("height",m);globalSpreadbox[g].rowsline[h].css("line-height",m);cellsr=globalSpreadbox[g].cells[h-1];for(var f=0;f<cellsr.length;f++){cellsr[f].css("height",m);cellsr[f].css("line-height",m)}globalSpreadbox[g].sizeHztdiv=0;globalSpreadbox[g].updateCmpEditable(g);if(globalSpreadbox[g].selector2.cell1!=null){globalSpreadbox[g].positionSelector(globalSpreadbox[g].selector2.cell1,g);globalSpreadbox[g].positionSelection(globalSpreadbox[g].selector2.cell1,globalSpreadbox[g].selector2.cell2,g);globalSpreadbox[g].selector3.offset({top:globalSpreadbox[g].SY,left:globalSpreadbox[g].SX})}}globalSpreadbox[g].resizecolumnboxDown=null;globalSpreadbox[g].resizerowboxDown=null;globalSpreadbox[g].sizeableVrtdiv.css("display","none");globalSpreadbox[g].sizeableHztdiv.css("display","none");globalSpreadbox[g].sheetMouseDown=false;if(globalSpreadbox[g].firstcell!=null){globalSpreadbox[g].selector3.css("visibility","visible");globalSpreadbox[g].selector3.offset({top:globalSpreadbox[g].SY,left:globalSpreadbox[g].SX})}if(globalSpreadbox[g].selector2.css("visibility")!=="hidden"){globalSpreadbox[g].selector2.addClass("selector2_border")}globalSpreadbox[g].selectHeaders(globalSpreadbox[g].firstcell,globalSpreadbox[g].secondcell,true,g);globalSpreadbox[g].firstcell=null};globalSpreadbox[a].mousemove=function(j,c){globalSpreadbox[c].sheetBarreLeft=false;globalSpreadbox[c].sheetBarreTop=false;globalSpreadbox[c].horizontalSlide=0;if(j.pageX>$("#sheet_"+c).offset().left+$("#sheet_"+c).get()[0].clientWidth){globalSpreadbox[c].horizontalSlide=1}if(j.pageX<$("#sheet_"+c).offset().left){globalSpreadbox[c].horizontalSlide=-1}globalSpreadbox[c].verticalSlide=0;if(j.pageY>$("#sheet_"+c).offset().top+$("#sheet_"+c).get()[0].clientHeight){globalSpreadbox[c].verticalSlide=1}if(j.pageY<$("#sheet_"+c).offset().top){globalSpreadbox[c].verticalSlide=-1}var h=globalSpreadbox[c].getCellFromCursor(j,c);if(globalSpreadbox[c].sheetMouseDown&&globalSpreadbox[c].resizecolumnboxDown!=null){var b=globalSpreadbox[c].resizecolumnboxX+j.pageX-globalSpreadbox[c].resizecolumnboxDown;if(globalSpreadbox[c].horizontalSlide==0){var d=globalSpreadbox[c].columnshead[globalSpreadbox[c].sizeableIndex];globalSpreadbox[c].sizeVrtdiv=j.pageX-globalSpreadbox[c].resizecolumnboxDown;if(d.width()+globalSpreadbox[c].sizeVrtdiv<=10){return}globalSpreadbox[c].sizeableVrtdiv.offset({left:b})}return}if(globalSpreadbox[c].sheetMouseDown&&globalSpreadbox[c].resizerowboxDown!=null){var f=globalSpreadbox[c].resizerowboxY+j.pageY-globalSpreadbox[c].resizerowboxDown;if(globalSpreadbox[c].verticalSlide==0){var g=globalSpreadbox[c].rowshead[globalSpreadbox[c].sizeableIndex];globalSpreadbox[c].sizeHztdiv=j.pageY-globalSpreadbox[c].resizerowboxDown;if(g.height()+globalSpreadbox[c].sizeHztdiv<=10){return}globalSpreadbox[c].sizeableHztdiv.offset({top:f})}return}if(globalSpreadbox[c].horizontalSlide!=0){globalSpreadbox[c].sheetBarreLeft=true;globalSpreadbox[c].slideLeftToCell($(h),c)}else{globalSpreadbox[c].stopSlideLeft(c)}if(globalSpreadbox[c].verticalSlide!=0){globalSpreadbox[c].sheetBarreTop=true;globalSpreadbox[c].slideTopToCell($(h),c)}else{globalSpreadbox[c].stopSlideTop(c)}cell=$(h);if(!cell.hasClass("cell")){globalSpreadbox[c].selectHeaders(globalSpreadbox[c].firstcell,globalSpreadbox[c].secondcell,true,c)}if(globalSpreadbox[c].firstcell!=null&&cell.hasClass("cell")){globalSpreadbox[c].positionSelection(globalSpreadbox[c].firstcell,cell,c)}else{if(h!=null&&h.id==="selector1_"+c){globalSpreadbox[c].selector2.css("visibility","hidden")}}};globalSpreadbox[a].selectHeaders=function(p,o,f,m){if(p==null||o==null){return}if(!globalSpreadbox[m].sheetBarreTop||f){for(var l=0;l<globalSpreadbox[m].columnselected.length;l++){globalSpreadbox[m].columnselected[l].removeClass("columnselected")}globalSpreadbox[m].columnselected=[];var k=parseInt(p.get()[0].column.attr("index"));var j=parseInt(o.get()[0].column.attr("index"));var e=Math.min(k,j);var d=Math.max(k,j);for(var l=e;l<=d;l++){var n=globalSpreadbox[m].columnshead[l];n.addClass("columnselected");globalSpreadbox[m].columnselected.push(n)}}if(!globalSpreadbox[m].sheetBarreLeft||f){for(var l=0;l<globalSpreadbox[m].rowselected.length;l++){globalSpreadbox[m].rowselected[l].removeClass("rowselected")}globalSpreadbox[m].rowselected=[];var h=parseInt(p.get()[0].row.attr("index"));var g=parseInt(o.get()[0].row.attr("index"));var s=Math.min(h,g);var q=Math.max(h,g);for(var l=s;l<=q;l++){var b=globalSpreadbox[m].rowshead[l];b.addClass("rowselected");globalSpreadbox[m].rowselected.push(b)}}};globalSpreadbox[a].positionSelection=function(f,e,c){if(f!=null&&e!=null){globalSpreadbox[c].selector2.cell1=f;globalSpreadbox[c].selector2.cell2=e;globalSpreadbox[c].secondcell=e;globalSpreadbox[c].selectHeaders(f,e,false,c);x1=f.offset().left;x2=x1+f.width();x3=e.offset().left;x4=x3+e.width();y1=f.offset().top;y2=y1+f.height();y3=e.offset().top;y4=y3+e.height();X=Math.min(x1,x3)-1;Y=Math.min(y1,y3)-1;W=Math.max(x2,x4)-X-1;H=Math.max(y2,y4)-Y-1;globalSpreadbox[c].SY=Y+H-2;globalSpreadbox[c].SX=X+W-3;if(f.attr("address")===e.attr("address")){$("#selectedcell_"+c).html(f.attr("addresscell"));globalSpreadbox[c].selector2.css("visibility","hidden");return}var h=f.attr("addresscolumn");var d=f.attr("addressrow");var g=e.attr("addresscolumn");var b=e.attr("addressrow");if(x3<x1){h=e.attr("addresscolumn");g=f.attr("addresscolumn")}if(y3<y1){d=e.attr("addressrow");b=f.attr("addressrow")}$("#selectedcell_"+c).html((h+d)+":"+(g+b));if(globalSpreadbox[c].selector2.css("visibility")==="hidden"){globalSpreadbox[c].selector2.css("visibility","visible")}globalSpreadbox[c].selector2.css("width",(W-1+2)+"px");globalSpreadbox[c].selector2.css("height",(H+2)+"px");globalSpreadbox[c].selector2.css("marginTop","-"+(H+2)+"px");globalSpreadbox[c].selector2.offset({top:Y,left:X})}};globalSpreadbox[a].getVisiblesCells=function(h){var m=getRandomInt(1000,9999);globalSpreadbox[h].sheetScrolled=m;var n=globalSpreadbox[h].sheet.find(".row").get();var f=[];var b=globalSpreadbox[h].tabfeuilleBody.get()[0];var d=globalSpreadbox[h].functiondiv.get()[0];for(var g=0;g<n.length;g++){if(m!=globalSpreadbox[h].sheetScrolled){return}if($(n[g]).is_on_screen(globalSpreadbox[h].sheet)){f.push($(n[g]))}}var j=[];for(var g=0;g<f.length;g++){var e=f[g];var l=e.find(".cell").get();for(var k=0;k<l.length;k++){if(m!=globalSpreadbox[h].sheetScrolled){return}if($(l[k]).is_on_screen(globalSpreadbox[h].sheet)){j.push(l[k])}}}globalSpreadbox[h].visibleCells=j}}function resizeSpreadBox(a){if(typeof globalSpreadbox[a]==="undefined"){return}var d=globalSpreadbox[a].tabfeuilleBody;var c=d.width()-50;var b=d.height()-20-globalSpreadbox[a].functiondiv.get()[0].offsetHeight;$("#spreadbox_"+a+" #columnsbox_"+a).width(c);$("#spreadbox_"+a+" #rowsbox_"+a).height(b);$("#spreadbox_"+a+" #contener_"+a).width(c);$("#spreadbox_"+a+" #contener_"+a).height(b);$("#spreadbox_"+a+" #sheet_"+a).height(b);$("#spreadbox_"+a+" #sheet_"+a).width(c);$("#functionvalue_"+a).width(c-193);globalSpreadbox[a].functionEditorDiv.width(c-193);globalSpreadbox[a].functionEditorDiv.height(24);if(typeof globalSpreadbox[a].sizeableVrtdiv!=="undefined"){globalSpreadbox[a].sizeableVrtdiv.height(globalSpreadbox[a].tabfeuilleBody.height()-globalSpreadbox[a].functiondiv.get()[0].offsetHeight)}if(typeof globalSpreadbox[a].sizeableHztdiv!=="undefined"){globalSpreadbox[a].sizeableHztdiv.width(globalSpreadbox[a].tabfeuilleBody.width())}if(typeof globalSpreadbox[a]!=="undefined"&&typeof globalSpreadbox[a].getVisiblesCells!=="undefined"){globalSpreadbox[a].getVisiblesCells(a)}}function startSpreadBox(a){initSpreadBox(a);globalSpreadbox[a].addmatrix(100,26,a);globalSpreadbox[a].getVisiblesCells(a)};